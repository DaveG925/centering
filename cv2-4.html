<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Card Centering Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.5.0/fabric.min.js"></script>
    <style>
       body, html {
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #FFFFFF;
    }

    canvas {
        border: 1px solid #ccc;
    }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const urlParams = new URLSearchParams(window.location.search);
    const imageURL = urlParams.get('imageURL');
    const cardID = urlParams.get('CardID');  // Retrieve CardID from URL
    const isFront = urlParams.get('isFront'); // Retrieve isFront from URL

    // You can now use these values as needed within your application
    if (imageURL) {
        loadImage(imageURL);
    }

    console.log("Card ID:", cardID);
    console.log("Is Front:", isFront);

    // Depending on the application, you may want to handle these variables differently
    // For example, adjust functionality based on whether isFront is 'true'
});

const canvas = new fabric.Canvas('canvas', { selection: false });
let overlayImage;

function loadImage(imageURL) {
    fabric.Image.fromURL(imageURL, function (img) {
        img.selectable = false;
        canvas.add(img);
        img.sendToBack();
    });
}

canvas.on('mouse:down', function(options) {
    const pointer = canvas.getPointer(options.e);
    if (!overlayImage) {
        addOverlayImage(pointer.x, pointer.y);
    }
});

function addOverlayImage(left, top) {
    fabric.Image.fromURL('https://raw.githubusercontent.com/DaveG925/centering/main/centering2.png', function (img) {
        overlayImage = img;
        overlayImage.set({
            left: left,
            top: top,
            scaleX: 0.5, // Adjust the initial scale as needed
            scaleY: 0.5,
            originX: 'left',
            originY: 'top',
            transparentCorners: false,
            cornerColor: 'blue',
            cornerSize: 10,
            selectable: true,
            hasBorders: false,
            hasControls: false,
        });
        canvas.add(overlayImage);
    });
}

canvas.on('object:moving', function(e) {
    const obj = e.target;
    if (obj === overlayImage) {
        updateQuadrilateral(obj);
    }
});

function updateQuadrilateral(obj) {
    // Write your code to update the quadrilateral based on the overlay image position
}

</script>
</body>
</html>
