<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f7f7f7;
        }
        canvas {
            border: 1px solid #ccc;
            max-width: 100%;
            max-height: 100vh; /* Maintain aspect ratio and fit screen */
            box-sizing: border-box;
        }
    </style>
    <title>Canvas with Adjustable Crossing Lines and Axis-Locked Handles</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.5.0/fabric.min.js"></script>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
    const canvas = new fabric.Canvas('canvas', {
        selection: false,
        hoverCursor: 'pointer',
    });

    function adjustCanvas() {
        const size = Math.min(window.innerWidth, window.innerHeight);
        canvas.setWidth(size);
        canvas.setHeight(size);
        updateHandlesPositions();
        updateLines();
    }

    function createHandle(left, top, horizontalLock) {
        const handle = new fabric.Rect({
            left: left,
            top: top,
            fill: 'blue',
            width: 10,
            height: 10,
            originX: 'center',
            originY: 'center',
            hasBorders: false,
            hasControls: false,
            selectable: true,
        });

        handle.on('moving', function() {
            if (horizontalLock) {
                this.set('top', top);
            } else {
                this.set('left', left);
            }
            updateLines();
        });

        canvas.add(handle);
        return handle;
    }

    function updateHandlesPositions() {
        handles.top1.set({ left: canvas.width * 0.15, top: 10 });
        handles.top2.set({ left: canvas.width * 0.85, top: 10 });
        handles.right1.set({ left: canvas.width - 10, top: canvas.height * 0.15 });
        handles.right2.set({ left: canvas.width - 10, top: canvas.height * 0.6 });
        handles.bottom1.set({ left: canvas.width * 0.15, top: canvas.height - 10 });
        handles.bottom2.set({ left: canvas.width * 0.85, top: canvas.height - 10 });
        handles.left1.set({ left: 10, top: canvas.height * 0.15 });
        handles.left2.set({ left: 10, top: canvas.height * 0.6 });
    }

    const handles = {
        top1: createHandle(150, 10, true),
        top2: createHandle(874, 10, true),
        right1: createHandle(canvas.width - 10, 150, false),
        right2: createHandle(canvas.width - 10, 618, false),
        bottom1: createHandle(150, canvas.height - 10, true),
        bottom2: createHandle(874, canvas.height - 10, true),
        left1: createHandle(10, 150, false),
        left2: createHandle(10, 618, false),
    };

    let lines = [];

    function updateLines() {
        lines.forEach(line => canvas.remove(line));
        lines = [
            new fabric.Line([handles.top1.left, handles.top1.top, handles.bottom1.left, handles.bottom1.top], { stroke: 'red', selectable: false }),
            new fabric.Line([handles.top2.left, handles.top2.top, handles.bottom2.left, handles.bottom2.top], { stroke: 'red', selectable: false }),
            new fabric.Line([handles.left1.left, handles.left1.top, handles.right1.left, handles.right1.top], { stroke: 'red', selectable: false }),
            new fabric.Line([handles.left2.left, handles.left2.top, handles.right2.left, handles.right2.top], { stroke: 'red', selectable: false }),
        ];

        lines.forEach(line => canvas.add(line));
        canvas.renderAll();
    }

    updateLines();
    window.addEventListener('resize', adjustCanvas);
    adjustCanvas(); // Initial setup
</script>

</body>
</html>
